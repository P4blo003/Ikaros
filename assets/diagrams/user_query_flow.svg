<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="919px" preserveAspectRatio="none" style="width:1845px;height:919px;background:#FFFFFF;" version="1.1" viewBox="0 0 1845 919" width="1845px" zoomAndPan="magnify"><title>Flujo Consulta Usuario</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="178.0283" x="835.4253" y="27.9951">Flujo Consulta Usuario</text><rect fill="none" height="148.4688" style="stroke:#000000;stroke-width:1.5;" width="655.2246" x="1101.3223" y="281.2578"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="19.9551" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="118.5938" y2="838.4531"/></g><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="246.02" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="249.7549" x2="249.7549" y1="118.5938" y2="838.4531"/></g><g><title>API Gateway</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="442.1113" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="445.8896" x2="445.8896" y1="118.5938" y2="838.4531"/></g><g><title>Streaming Service</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="638.2026" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="641.8013" x2="641.8013" y1="118.5938" y2="838.4531"/></g><g><title>CHAT Service</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="773.9155" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="777.604" x2="777.604" y1="118.5938" y2="838.4531"/></g><g><title>RAG Service</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="1047.1499" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1050.9775" x2="1050.9775" y1="118.5938" y2="838.4531"/></g><g><title>USER Service</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="1161.2715" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1164.3223" x2="1164.3223" y1="118.5938" y2="838.4531"/></g><g><title>OLLAMA Service</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="1289.2427" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1293.2207" x2="1293.2207" y1="118.5938" y2="838.4531"/></g><g><title>Message Queue</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="1514.1753" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1517.2744" x2="1517.2744" y1="118.5938" y2="838.4531"/></g><g><title>REDIS DB</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="1626.6782" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1630.0762" x2="1630.0762" y1="118.5938" y2="838.4531"/></g><g><title>CHAT DB</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="1707.9136" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1711.2803" x2="1711.2803" y1="118.5938" y2="838.4531"/></g><g><title>VECTOR DB</title><rect fill="#000000" fill-opacity="0.00000" height="719.8594" width="8" x="1796.7129" y="118.5938"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1800.5469" x2="1800.5469" y1="118.5938" y2="838.4531"/></g><g class="participant participant-head" data-participant="actor"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="115.292">User</text><ellipse cx="23.9551" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,58.7969 L23.9551,85.7969 M10.9551,66.7969 L36.9551,66.7969 M23.9551,85.7969 L10.9551,100.7969 M23.9551,85.7969 L36.9551,100.7969" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="actor"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="850.4482">User</text><ellipse cx="23.9551" cy="862.25" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,870.25 L23.9551,897.25 M10.9551,878.25 L36.9551,878.25 M23.9551,897.25 L10.9551,912.25 M23.9551,897.25 L36.9551,912.25" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.5303" x="222.7549" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="229.7549" y="107.292">Client</text></g><g class="participant participant-tail" data-participant="client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.5303" x="222.7549" y="837.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="229.7549" y="857.4482">Client</text></g><g class="participant participant-head" data-participant="gateway"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102.4434" x="394.8896" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.4434" x="401.8896" y="107.292">API Gateway</text></g><g class="participant participant-tail" data-participant="gateway"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102.4434" x="394.8896" y="837.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.4434" x="401.8896" y="857.4482">API Gateway</text></g><g class="participant participant-head" data-participant="stream"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142.8027" x="570.8013" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.8027" x="577.8013" y="107.292">Streaming Service</text></g><g class="participant participant-tail" data-participant="stream"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="142.8027" x="570.8013" y="837.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="128.8027" x="577.8013" y="857.4482">Streaming Service</text></g><g class="participant participant-head" data-participant="chat"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.623" x="723.604" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.623" x="730.604" y="107.292">CHAT Service</text></g><g class="participant participant-tail" data-participant="chat"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.623" x="723.604" y="837.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.623" x="730.604" y="857.4482">CHAT Service</text></g><g class="participant participant-head" data-participant="rag"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100.3447" x="1000.9775" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.3447" x="1007.9775" y="107.292">RAG Service</text></g><g class="participant participant-tail" data-participant="rag"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100.3447" x="1000.9775" y="837.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="86.3447" x="1007.9775" y="857.4482">RAG Service</text></g><g class="participant participant-head" data-participant="user"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.8984" x="1111.3223" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.8984" x="1118.3223" y="107.292">USER Service</text></g><g class="participant participant-tail" data-participant="user"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="107.8984" x="1111.3223" y="837.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93.8984" x="1118.3223" y="857.4482">USER Service</text></g><g class="participant participant-head" data-participant="ollama"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128.0439" x="1229.2207" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.0439" x="1236.2207" y="107.292">OLLAMA Service</text></g><g class="participant participant-tail" data-participant="ollama"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="128.0439" x="1229.2207" y="837.4531"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="114.0439" x="1236.2207" y="857.4482">OLLAMA Service</text></g><g class="participant participant-head" data-participant="queue"><path d="M1457.2744,92.2969 L1579.0762,92.2969 C1584.0762,92.2969 1584.0762,105.4453 1584.0762,105.4453 C1584.0762,105.4453 1584.0762,118.5938 1579.0762,118.5938 L1457.2744,118.5938 C1452.2744,118.5938 1452.2744,105.4453 1452.2744,105.4453 C1452.2744,105.4453 1452.2744,92.2969 1457.2744,92.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1579.0762,92.2969 C1574.0762,92.2969 1574.0762,105.4453 1574.0762,105.4453 C1574.0762,118.5938 1579.0762,118.5938 1579.0762,118.5938" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.8018" x="1457.2744" y="110.292">Message Queue</text></g><g class="participant participant-tail" data-participant="queue"><path d="M1457.2744,837.4531 L1579.0762,837.4531 C1584.0762,837.4531 1584.0762,850.6016 1584.0762,850.6016 C1584.0762,850.6016 1584.0762,863.75 1579.0762,863.75 L1457.2744,863.75 C1452.2744,863.75 1452.2744,850.6016 1452.2744,850.6016 C1452.2744,850.6016 1452.2744,837.4531 1457.2744,837.4531" fill="#E2E2F0" style="stroke:#181818;stroke-width:0.5;"/><path d="M1579.0762,837.4531 C1574.0762,837.4531 1574.0762,850.6016 1574.0762,850.6016 C1574.0762,863.75 1579.0762,863.75 1579.0762,863.75" fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="111.8018" x="1457.2744" y="855.4482">Message Queue</text></g><g class="participant participant-head" data-participant="redisDB"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.2041" x="1594.0762" y="115.292">REDIS DB</text><path d="M1612.6782,66.2969 C1612.6782,56.2969 1630.6782,56.2969 1630.6782,56.2969 C1630.6782,56.2969 1648.6782,56.2969 1648.6782,66.2969 L1648.6782,92.2969 C1648.6782,102.2969 1630.6782,102.2969 1630.6782,102.2969 C1630.6782,102.2969 1612.6782,102.2969 1612.6782,92.2969 L1612.6782,66.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1612.6782,66.2969 C1612.6782,76.2969 1630.6782,76.2969 1630.6782,76.2969 C1630.6782,76.2969 1648.6782,76.2969 1648.6782,66.2969" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="redisDB"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="67.2041" x="1594.0762" y="850.4482">REDIS DB</text><path d="M1612.6782,863.75 C1612.6782,853.75 1630.6782,853.75 1630.6782,853.75 C1630.6782,853.75 1648.6782,853.75 1648.6782,863.75 L1648.6782,889.75 C1648.6782,899.75 1630.6782,899.75 1630.6782,899.75 C1630.6782,899.75 1612.6782,899.75 1612.6782,889.75 L1612.6782,863.75" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1612.6782,863.75 C1612.6782,873.75 1630.6782,873.75 1630.6782,873.75 C1630.6782,873.75 1648.6782,873.75 1648.6782,863.75" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-head" data-participant="chatDB"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.2666" x="1677.2803" y="115.292">CHAT DB</text><path d="M1693.9136,66.2969 C1693.9136,56.2969 1711.9136,56.2969 1711.9136,56.2969 C1711.9136,56.2969 1729.9136,56.2969 1729.9136,66.2969 L1729.9136,92.2969 C1729.9136,102.2969 1711.9136,102.2969 1711.9136,102.2969 C1711.9136,102.2969 1693.9136,102.2969 1693.9136,92.2969 L1693.9136,66.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1693.9136,66.2969 C1693.9136,76.2969 1711.9136,76.2969 1711.9136,76.2969 C1711.9136,76.2969 1729.9136,76.2969 1729.9136,66.2969" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="chatDB"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="63.2666" x="1677.2803" y="850.4482">CHAT DB</text><path d="M1693.9136,863.75 C1693.9136,853.75 1711.9136,853.75 1711.9136,853.75 C1711.9136,853.75 1729.9136,853.75 1729.9136,863.75 L1729.9136,889.75 C1729.9136,899.75 1711.9136,899.75 1711.9136,899.75 C1711.9136,899.75 1693.9136,899.75 1693.9136,889.75 L1693.9136,863.75" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1693.9136,863.75 C1693.9136,873.75 1711.9136,873.75 1711.9136,873.75 C1711.9136,873.75 1729.9136,873.75 1729.9136,863.75" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-head" data-participant="vectorDB"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.332" x="1756.5469" y="115.292">VECTOR DB</text><path d="M1782.7129,66.2969 C1782.7129,56.2969 1800.7129,56.2969 1800.7129,56.2969 C1800.7129,56.2969 1818.7129,56.2969 1818.7129,66.2969 L1818.7129,92.2969 C1818.7129,102.2969 1800.7129,102.2969 1800.7129,102.2969 C1800.7129,102.2969 1782.7129,102.2969 1782.7129,92.2969 L1782.7129,66.2969" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1782.7129,66.2969 C1782.7129,76.2969 1800.7129,76.2969 1800.7129,76.2969 C1800.7129,76.2969 1818.7129,76.2969 1818.7129,66.2969" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="participant participant-tail" data-participant="vectorDB"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82.332" x="1756.5469" y="850.4482">VECTOR DB</text><path d="M1782.7129,863.75 C1782.7129,853.75 1800.7129,853.75 1800.7129,853.75 C1800.7129,853.75 1818.7129,853.75 1818.7129,863.75 L1818.7129,889.75 C1818.7129,899.75 1800.7129,899.75 1800.7129,899.75 C1800.7129,899.75 1782.7129,899.75 1782.7129,889.75 L1782.7129,863.75" fill="#E2E2F0" style="stroke:#181818;stroke-width:1.5;"/><path d="M1782.7129,863.75 C1782.7129,873.75 1800.7129,873.75 1800.7129,873.75 C1800.7129,873.75 1818.7129,873.75 1818.7129,863.75" fill="none" style="stroke:#181818;stroke-width:1.5;"/></g><g class="message" data-participant-1="actor" data-participant-2="client"><polygon fill="#181818" points="238.02,145.7266,248.02,149.7266,238.02,153.7266,242.02,149.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="23.9551" x2="244.02" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.2656" x="30.9551" y="144.6606">Introduce consulta</text></g><g class="message" data-participant-1="client" data-participant-2="gateway"><polygon fill="#181818" points="434.1113,174.8594,444.1113,178.8594,434.1113,182.8594,438.1113,178.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="250.02" x2="440.1113" y1="178.8594" y2="178.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="100.6421" x="257.02" y="173.7935">POST (con JWT)</text></g><g class="message" data-participant-1="gateway" data-participant-2="chat"><polygon fill="#181818" points="765.9155,203.9922,775.9155,207.9922,765.9155,211.9922,769.9155,207.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="446.1113" x2="771.9155" y1="207.9922" y2="207.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.855" x="453.1113" y="202.9263">Redirige la petici&#243;n</text></g><g class="message" data-participant-1="chat" data-participant-2="user"><polygon fill="#181818" points="1153.2715,233.125,1163.2715,237.125,1153.2715,241.125,1157.2715,237.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="777.9155" x2="1159.2715" y1="237.125" y2="237.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="103.5938" x="784.9155" y="232.0591">Solicita historial</text></g><g class="message" data-participant-1="user" data-participant-2="redisDB"><polygon fill="#181818" points="1618.6782,262.2578,1628.6782,266.2578,1618.6782,270.2578,1622.6782,266.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1165.2715" x2="1624.6782" y1="266.2578" y2="266.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.3682" x="1172.2715" y="261.1919">Solicita historial (cach&#233;)</text></g><path d="M1101.3223,281.2578 L1165.7651,281.2578 L1165.7651,288.3906 L1155.7651,298.3906 L1101.3223,298.3906 L1101.3223,281.2578" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="148.4688" style="stroke:#000000;stroke-width:1.5;" width="655.2246" x="1101.3223" y="281.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="1116.3223" y="294.3247">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="68.0518" x="1180.7651" y="293.4683">[Cache hit]</text><g class="message" data-participant-1="redisDB" data-participant-2="user"><polygon fill="#181818" points="1176.2715,315.5234,1166.2715,319.5234,1176.2715,323.5234,1172.2715,319.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1170.2715" x2="1629.6782" y1="319.5234" y2="319.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.3262" x="1182.2715" y="314.4575">Devuelve el historial</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="1101.3223" x2="1756.5469" y1="328.5234" y2="328.5234"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="79.519" x="1106.3223" y="338.7339">[Cache miss]</text><g class="message" data-participant-1="user" data-participant-2="chatDB"><polygon fill="#181818" points="1699.9136,359.4609,1709.9136,363.4609,1699.9136,367.4609,1703.9136,363.4609" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1165.2715" x2="1705.9136" y1="363.4609" y2="363.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="119.3359" x="1172.2715" y="358.395">Solicita el historial</text></g><g class="message" data-participant-1="chatDB" data-participant-2="user"><polygon fill="#181818" points="1176.2715,388.5938,1166.2715,392.5938,1176.2715,396.5938,1172.2715,392.5938" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1170.2715" x2="1710.9136" y1="392.5938" y2="392.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.3262" x="1182.2715" y="387.5278">Devuelve el historial</text></g><g class="message" data-participant-1="user" data-participant-2="redisDB"><polygon fill="#181818" points="1618.6782,417.7266,1628.6782,421.7266,1618.6782,425.7266,1622.6782,421.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1165.2715" x2="1624.6782" y1="421.7266" y2="421.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="173.2656" x="1172.2715" y="416.6606">Guarda en cach&#233; (TTL: 1h)</text></g><g class="message" data-participant-1="user" data-participant-2="chat"><polygon fill="#181818" points="788.9155,453.8594,778.9155,457.8594,788.9155,461.8594,784.9155,457.8594" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="782.9155" x2="1164.2715" y1="457.8594" y2="457.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.3262" x="794.9155" y="452.7935">Devuelve el historial</text></g><g class="message" data-participant-1="chat" data-participant-2="rag"><polygon fill="#181818" points="1039.1499,482.9922,1049.1499,486.9922,1039.1499,490.9922,1043.1499,486.9922" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="777.9155" x2="1045.1499" y1="486.9922" y2="486.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="249.2344" x="784.9155" y="481.9263">Solicita contexto (consulta + historial)</text></g><g class="message" data-participant-1="rag" data-participant-2="vectorDB"><polygon fill="#181818" points="1788.7129,512.125,1798.7129,516.125,1788.7129,520.125,1792.7129,516.125" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1051.1499" x2="1794.7129" y1="516.125" y2="516.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="136.2334" x="1058.1499" y="511.0591">B&#250;squeda sem&#225;ntica</text></g><g class="message" data-participant-1="rag" data-participant-2="chat"><polygon fill="#181818" points="788.9155,541.2578,778.9155,545.2578,788.9155,549.2578,784.9155,545.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="782.9155" x2="1050.1499" y1="545.2578" y2="545.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="122.5542" x="794.9155" y="540.1919">Devuelve contexto</text></g><g class="message" data-participant-1="chat" data-participant-2="queue"><polygon fill="#181818" points="1506.1753,570.3906,1516.1753,574.3906,1506.1753,578.3906,1510.1753,574.3906" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="777.9155" x2="1512.1753" y1="574.3906" y2="574.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.438" x="784.9155" y="569.3247">Publica tarea de generaci&#243;n</text></g><g class="message" data-participant-1="queue" data-participant-2="ollama"><polygon fill="#181818" points="1304.2427,599.5234,1294.2427,603.5234,1304.2427,607.5234,1300.2427,603.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="1298.2427" x2="1517.1753" y1="603.5234" y2="603.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="99.4487" x="1310.2427" y="598.4575">Consume tarea</text></g><g class="message" data-participant-1="ollama" data-participant-2="ollama"><line style="stroke:#181818;stroke-width:1;" x1="1293.2427" x2="1335.2427" y1="632.6563" y2="632.6563"/><line style="stroke:#181818;stroke-width:1;" x1="1335.2427" x2="1335.2427" y1="632.6563" y2="645.6563"/><line style="stroke:#181818;stroke-width:1;" x1="1294.2427" x2="1335.2427" y1="645.6563" y2="645.6563"/><polygon fill="#181818" points="1304.2427,641.6563,1294.2427,645.6563,1304.2427,649.6563,1300.2427,645.6563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="210.9326" x="1300.2427" y="627.5903">Genera respuesta (streamizada)</text></g><g class="message" data-participant-1="ollama" data-participant-2="stream"><polygon fill="#181818" points="653.2026,670.7891,643.2026,674.7891,653.2026,678.7891,649.2026,674.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="647.2026" x2="1292.2427" y1="674.7891" y2="674.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="225.8813" x="659.2026" y="669.7231">Env&#237;a chunks (v&#237;a WebSocket/SSE)</text></g><g class="message" data-participant-1="stream" data-participant-2="gateway"><polygon fill="#181818" points="457.1113,699.9219,447.1113,703.9219,457.1113,707.9219,453.1113,703.9219" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="451.1113" x2="641.2026" y1="703.9219" y2="703.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.0913" x="463.1113" y="698.856">Streaming de la respuesta</text></g><g class="message" data-participant-1="gateway" data-participant-2="client"><polygon fill="#181818" points="261.02,729.0547,251.02,733.0547,261.02,737.0547,257.02,733.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="255.02" x2="445.1113" y1="733.0547" y2="733.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="172.0913" x="267.02" y="727.9888">Streaming de la respuesta</text></g><g class="message" data-participant-1="client" data-participant-2="actor"><polygon fill="#181818" points="34.9551,758.1875,24.9551,762.1875,34.9551,766.1875,30.9551,762.1875" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="28.9551" x2="249.02" y1="762.1875" y2="762.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202.0649" x="40.9551" y="757.1216">Muestra chunks en tiempo real</text></g><g class="message" data-participant-1="chat" data-participant-2="chatDB"><polygon fill="#181818" points="1699.9136,787.3203,1709.9136,791.3203,1699.9136,795.3203,1703.9136,791.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="777.9155" x2="1705.9136" y1="791.3203" y2="791.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="256.3628" x="784.9155" y="786.2544">Almacena mensaje y respuesta (async)</text></g><g class="message" data-participant-1="chat" data-participant-2="redisDB"><polygon fill="#181818" points="1618.6782,816.4531,1628.6782,820.4531,1618.6782,824.4531,1622.6782,820.4531" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="777.9155" x2="1624.6782" y1="820.4531" y2="820.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="230.7944" x="784.9155" y="815.3872">Actualiza historial en cach&#233; (async)</text></g><!--SRC=[VLHDSzCm4BthL-pq50-JqfOM61yof4aQMf9fYPFslBMNHAqi1qiAb7_3aGCdRbppnrXRTc8pb4CcblRjrzktij8gWWlb7Z8OPDeuPH4Mnc4kCo4mjbdEHye13PGdiSRSobYkKLiOA4dynxQu_18jwq7_vXB6QEaBFXqKeAN_ReCYcnEcKYyXedmZOogXfhnj8mVl-_CMA5wXRKDc_N4BaUEo3LX4eraBuRYvDkHwCkbF-orGfXIcACHdHuxWO4h6u9BWOt4i0QL1Y0GjtgDXo6mql8nWUEwhe4IQuNd3NBPIMOikMiRRqM1-FQlD6ofePq0rZcxFSnt2fRPvbhYO8Auc9xofswkO3k7cEff3X-rmTJSFH7NFCJXf23CkB9VSYK9OKq71zfSMeZ1sUmKp8KIPuciMnKeQpYvHYSBGxLLD_Gl12J5URNy40XMBXB-9ZLP0pKGTV4WRHsf3GAeHdnIpuBrIQGox-OoUg4R2bXTKHFu_TXrhL_sOfPvmA0s-PkZCvvCGZbU189s8VURd8bPiiT8QbJ7XbhxQhAJUBzMBlKyW6DtjrPCDuNpxsx24k0v3wVQxvacWn_oLkOvRPorrnrDszvmOmI9l3IG4IzAKenzdYUdsl8P3l-KfUQpmjtlhk7JaEPcr8yDbT_mcoc-OO21sU7yRmaXljZ-vtvNJZmOwvU6ExgCiVYJxCef6WV3GXYRt6v-KojibQyYpalZpq5hfvKw4C2rkyrqXF4uhALrdxB6VKIsWlaen9esGaZRuGF3KR1ZDauw3UgorJlgnTQYOXeRC6wAfdCGx5Wsub5FUA7vD5jC9Bt1k92_WyU79qSdPuQjEv7WR-NTq34SduTcRyEGKfiCv5EP0TCOt4p2PotclERVDvRspx1-8AzmWp1oh8-MPNwz9Nmq_r1V596IUwRHuXgzkftl0wzFkkRJbUyRl-ErK3EaJiYJP8yuIvZQ4nVoY-rPCK2yTlsiXDoO66SVDULhQAVK7]--></g></svg>