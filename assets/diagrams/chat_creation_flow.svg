<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="760px" preserveAspectRatio="none" style="width:518px;height:760px;background:#FFFFFF;" version="1.1" viewBox="0 0 518 760" width="518px" zoomAndPan="magnify"><title>Flujo Inicio Chat de Usuarios</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="225.5996" x="145.8879" y="27.9951">Flujo Inicio Chat de Usuarios</text><rect fill="none" height="328.3984" style="stroke:#000000;stroke-width:1.5;" width="448.1016" x="42.9102" y="333.8516"/><g><title>User</title><rect fill="#000000" fill-opacity="0.00000" height="493.0625" width="8" x="19.9551" y="186.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="23" x2="23" y1="186.1875" y2="679.25"/></g><g><title>Client</title><rect fill="#000000" fill-opacity="0.00000" height="493.0625" width="8" x="76.1753" y="186.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="79.9102" x2="79.9102" y1="186.1875" y2="679.25"/></g><g><title>API Gateway</title><rect fill="#000000" fill-opacity="0.00000" height="493.0625" width="8" x="282.4419" y="186.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="286.2202" x2="286.2202" y1="186.1875" y2="679.25"/></g><g><title>AUTH Service</title><rect fill="#000000" fill-opacity="0.00000" height="493.0625" width="8" x="422.4644" y="186.1875"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="425.917" x2="425.917" y1="186.1875" y2="679.25"/></g><g class="participant participant-head" data-participant="user"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="182.8857">User</text><ellipse cx="23.9551" cy="118.3906" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,126.3906 L23.9551,153.3906 M10.9551,134.3906 L36.9551,134.3906 M23.9551,153.3906 L10.9551,168.3906 M23.9551,153.3906 L36.9551,168.3906" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-tail" data-participant="user"><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31.9102" x="5" y="691.2451">User</text><ellipse cx="23.9551" cy="703.0469" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M23.9551,711.0469 L23.9551,738.0469 M10.9551,719.0469 L36.9551,719.0469 M23.9551,738.0469 L10.9551,753.0469 M23.9551,738.0469 L36.9551,753.0469" fill="none" style="stroke:#181818;stroke-width:0.5;"/></g><g class="participant participant-head" data-participant="client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.5303" x="52.9102" y="154.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="59.9102" y="174.8857">Client</text></g><g class="participant participant-tail" data-participant="client"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="54.5303" x="52.9102" y="678.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="40.5303" x="59.9102" y="698.2451">Client</text></g><g class="participant participant-head" data-participant="gateway"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102.4434" x="235.2202" y="154.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.4434" x="242.2202" y="174.8857">API Gateway</text></g><g class="participant participant-tail" data-participant="gateway"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102.4434" x="235.2202" y="678.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="88.4434" x="242.2202" y="698.2451">API Gateway</text></g><g class="participant participant-head" data-participant="auth"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.0947" x="371.917" y="154.8906"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.0947" x="378.917" y="174.8857">AUTH Service</text></g><g class="participant participant-tail" data-participant="auth"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109.0947" x="371.917" y="678.25"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95.0947" x="378.917" y="698.2451">AUTH Service</text></g><g class="message" data-participant-1="client" data-participant-2="gateway"><polygon fill="#0000FF" points="274.4419,228.4531,284.4419,232.4531,274.4419,236.4531,278.4419,232.4531" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="80.1753" x2="280.4419" y1="232.4531" y2="232.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="71.8936" x="87.1753" y="212.2544">HTTP POST</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34.7725" x="87.1753" y="227.3872">(JWT)</text></g><g class="message" data-participant-1="gateway" data-participant-2="auth"><polygon fill="#800080" points="414.4644,272.7188,424.4644,276.7188,414.4644,280.7188,418.4644,276.7188" style="stroke:#800080;stroke-width:1;"/><line style="stroke:#800080;stroke-width:1;" x1="286.4419" x2="420.4644" y1="276.7188" y2="276.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="116.0225" x="293.4419" y="256.52">Delega validaci&#243;n</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="34.7725" x="293.4419" y="271.6528">(JWT)</text></g><g class="message" data-participant-1="auth" data-participant-2="auth"><line style="stroke:#181818;stroke-width:1;" x1="426.4644" x2="468.4644" y1="305.8516" y2="305.8516"/><line style="stroke:#181818;stroke-width:1;" x1="468.4644" x2="468.4644" y1="305.8516" y2="318.8516"/><line style="stroke:#181818;stroke-width:1;" x1="427.4644" x2="468.4644" y1="318.8516" y2="318.8516"/><polygon fill="#181818" points="437.4644,314.8516,427.4644,318.8516,437.4644,322.8516,433.4644,318.8516" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="77.9111" x="433.4644" y="300.7856">Verifica JWT</text></g><path d="M42.9102,333.8516 L107.353,333.8516 L107.353,340.9844 L97.353,350.9844 L42.9102,350.9844 L42.9102,333.8516" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="328.3984" style="stroke:#000000;stroke-width:1.5;" width="448.1016" x="42.9102" y="333.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="57.9102" y="346.9185">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="73.7021" x="122.353" y="346.062">[Incorrecto]</text><g class="message" data-participant-1="auth" data-participant-2="gateway"><polygon fill="#800080" points="297.4419,368.1172,287.4419,372.1172,297.4419,376.1172,293.4419,372.1172" style="stroke:#800080;stroke-width:1;"/><line style="stroke:#800080;stroke-width:1;" x1="291.4419" x2="425.4644" y1="372.1172" y2="372.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="66.0601" x="303.4419" y="367.0513">Incorrecto</text></g><g class="message" data-participant-1="gateway" data-participant-2="client"><polygon fill="#0000FF" points="91.1753,412.3828,81.1753,416.3828,91.1753,420.3828,87.1753,416.3828" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="85.1753" x2="285.4419" y1="416.3828" y2="416.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.4419" x="97.1753" y="396.1841">HTTP 401</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91.9458" x="97.1753" y="411.3169">No Autorizado</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="42.9102" x2="491.0117" y1="425.3828" y2="425.3828"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="63.3306" x="47.9102" y="435.5933">[Correcto]</text><g class="message" data-participant-1="auth" data-participant-2="gateway"><polygon fill="#800080" points="297.4419,456.3203,287.4419,460.3203,297.4419,464.3203,293.4419,460.3203" style="stroke:#800080;stroke-width:1;"/><line style="stroke:#800080;stroke-width:1;" x1="291.4419" x2="425.4644" y1="460.3203" y2="460.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="55.9165" x="303.4419" y="455.2544">Correcto</text></g><g class="message" data-participant-1="gateway" data-participant-2="gateway"><line style="stroke:#181818;stroke-width:1;" x1="286.4419" x2="328.4419" y1="489.4531" y2="489.4531"/><line style="stroke:#181818;stroke-width:1;" x1="328.4419" x2="328.4419" y1="489.4531" y2="502.4531"/><line style="stroke:#181818;stroke-width:1;" x1="287.4419" x2="328.4419" y1="502.4531" y2="502.4531"/><polygon fill="#181818" points="297.4419,498.4531,287.4419,502.4531,297.4419,506.4531,293.4419,502.4531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118.2378" x="293.4419" y="484.3872">Genera session_id</text></g><g class="message" data-participant-1="gateway" data-participant-2="gateway"><line style="stroke:#181818;stroke-width:1;" x1="286.4419" x2="328.4419" y1="546.7188" y2="546.7188"/><line style="stroke:#181818;stroke-width:1;" x1="328.4419" x2="328.4419" y1="546.7188" y2="559.7188"/><line style="stroke:#181818;stroke-width:1;" x1="287.4419" x2="328.4419" y1="559.7188" y2="559.7188"/><polygon fill="#181818" points="297.4419,555.7188,287.4419,559.7188,297.4419,563.7188,293.4419,559.7188" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.6934" x="293.4419" y="526.52">Registra session_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="101.4419" x="293.4419" y="541.6528">y Conexi&#243;n SSE</text></g><g class="message" data-participant-1="gateway" data-participant-2="client"><polygon fill="#0000FF" points="91.1753,599.9844,81.1753,603.9844,91.1753,607.9844,87.1753,603.9844" style="stroke:#0000FF;stroke-width:1;"/><line style="stroke:#0000FF;stroke-width:1;" x1="85.1753" x2="285.4419" y1="603.9844" y2="603.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.4419" x="97.1753" y="583.7856">HTTP 200</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="182.2666" x="97.1753" y="598.9185">(Cabeceras SSE, session_id)</text></g><path d="M85,616.9844 L85,656.9844 L357,656.9844 L357,626.9844 L347,616.9844 L85,616.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M347,616.9844 L347,626.9844 L357,626.9844 L347,616.9844" fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="251.8877" x="91" y="634.0513">Se inicia conexi&#243;n SSE cliente-servidor</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.8394" x="91" y="649.1841">que se mantiene abierta.</text><rect fill="#DDDDDD" height="42.5938" rx="7.5" ry="7.5" style="stroke:#000000;stroke-width:1;" width="86.8018" x="215.2869" y="54.2969"/><text fill="#0000FF" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.8018" x="220.2869" y="72.292">REST/HTTP</text><text fill="#800080" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36.832" x="220.2869" y="88.5889">gRPC</text><!--SRC=[XLDXZz904Fs-lsA2No0H3f1Jqro8P-6uG_0QMl236BEqGrcpx7BRNVJyM_u4_vYp1GvGaoCbtSvxy-RDT6g5bGYL6-c-QRXJ8XKQmXMta25C2yUDq4M5CPvQRIY01dW1ZkwCRRYnnDzmPQ4IIe7ALZoQbiTp-3gwWm6t-9q_bfnyT_wBD4rk8KQp5IcMBExiYh6TNltpYuLq-AMxJmtWDaaYYExZPAwgmqz9ZUqHOcwSsKZYUe40UYWnvx3bKcGy5Rz_gKE6n-jxrWoDM8gK0o7KiBGqZbGRWzGwWzBBYVAJYpFIqS7EwyxwtcgdsPghZngk7SrI_EIPPWnbWH0-NoNyjyOH7A12mw70eX1QVHNPVraJp4LXptXpzKZA2d_ucK0SzvzheTriqkX2li2KAXO-vUM9NetowLBQ8XYHhopevM4TW7unWl0hnY4zhRgdOBtmxpxJfYG_E2HfMDDg48h05mADvGq2KMLb4L-EpepH-_KngpSKkagrr2RmzhkJVfnSUEjN5sMqUyHtC-xcaoXy0ht8JeknT_x1hILZaIGFq_48jcXyfz1gj9ljoyQhQkmK3EdVR46p7Lo-2TeT6FSIy72DLGVH20hjJ8gG-TcBXREKNsD3lkKmSTJP6WEutw0QzZuS0j1NMs6qMlkn3MVZ8-5rf_vUsF8JeGznDcOzN797czgd9So4oWEO9ZVrjsp4LUvuJjgeMAX9rz06A2Vb7m00]--></g></svg>